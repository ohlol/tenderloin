// Peity jQuery plugin version 1.0.0
// (c) 2012 Ben Pickles
//
// http://benpickles.github.com/peity
//
// Released under MIT license.
(function(j,k,l,n){var p=k.createElement("canvas").getContext,h=j.fn.peity=function(a,b){p&&this.each(function(){var c=h.defaults[a],d={},e=j(this);j.each(e.data(),function(a,b){a in c&&(d[a]=b)});var f=j.extend({},c,d,b),m=new o(e,a,f);m.draw();e.change(function(){m.draw()})});return this},o=function(a,b,c){this.$elem=a;this.type=b;this.opts=c},k=o.prototype;k.colours=function(){var a=this.opts.colours,b=a;j.isFunction(b)||(b=function(b,d){return a[d%a.length]});return b};k.draw=function(){h.graphers[this.type].call(this,
this.opts)};k.prepareCanvas=function(a,b){var c=this.canvas;c?this.context.clearRect(0,0,c.width,c.height):(c=j("<canvas>").attr({height:b*n,width:a*n}),1!=n&&c.css({height:b,width:a}),this.canvas=c=c[0],this.context=c.getContext("2d"),this.$elem.hide().before(c));return c};k.values=function(){return j.map(this.$elem.text().split(this.opts.delimiter),function(a){return parseFloat(a)})};h.defaults={};h.graphers={};h.register=function(a,b,c){this.defaults[a]=b;this.graphers[a]=c};h.register("pie",{colours:["#ff9900",
"#fff4dd","#ffc66e"],delimiter:null,diameter:16},function(a){if(!a.delimiter){var b=this.$elem.text().match(/[^0-9\.]/);a.delimiter=b?b[0]:","}b=this.values();if("/"==a.delimiter)var c=b[0],b=[c,b[1]-c];for(var d=0,c=b.length,e=0;d<c;d++)e+=b[d];var d=this.prepareCanvas(a.diameter,a.diameter),a=this.context,f=d.width/2,m=l.PI,h=this.colours();a.save();a.translate(f,f);a.rotate(-m/2);for(d=0;d<c;d++){var i=b[d],g=2*i/e*m;a.beginPath();a.moveTo(0,0);a.arc(0,0,f,0,g,!1);a.fillStyle=h.call(this,i,d,b);
a.fill();a.rotate(g)}a.restore()});h.register("line",{colour:"#c6d9fd",strokeColour:"#4d89f9",strokeWidth:1,delimiter:",",height:16,max:null,min:0,width:32},function(a){var b=this.values();1==b.length&&b.push(b[0]);var c=l.max.apply(l,b.concat([a.max])),d=l.min.apply(l,b.concat([a.min])),e=this.prepareCanvas(a.width,a.height),f=this.context,m=e.width,e=e.height,h=m/(b.length-1),c=e/(c-d),i=[],g;f.beginPath();f.moveTo(0,e+d*c);for(g=0;g<b.length;g++){var j=g*h,k=e-c*(b[g]-d);i.push({x:j,y:k});f.lineTo(j,
k)}f.lineTo(m,e+d*c);f.fillStyle=a.colour;f.fill();if(a.strokeWidth){f.beginPath();f.moveTo(0,i[0].y);for(g=0;g<i.length;g++)f.lineTo(i[g].x,i[g].y);f.lineWidth=a.strokeWidth*n;f.strokeStyle=a.strokeColour;f.stroke()}});h.register("bar",{colours:["#4D89F9"],delimiter:",",height:16,max:null,min:0,spacing:n,width:32},function(a){for(var b=this.values(),c=l.max.apply(l,b.concat([a.max])),d=l.min.apply(l,b.concat([a.min])),e=this.prepareCanvas(a.width,a.height),f=this.context,h=e.height,c=h/(c-d),a=a.spacing,
e=(e.width+a)/b.length,j=this.colours(),i=0;i<b.length;i++){var g=b[i],k=i*e,n=h-c*(g-d);f.fillStyle=j.call(this,g,i,b);f.fillRect(k,n,e-a,c*b[i])}})})(jQuery,document,Math,window.devicePixelRatio||1);
